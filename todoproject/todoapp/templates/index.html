<!DOCTYPE html>
<html>
<head>
  <title>To-Do App</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .done { text-decoration: line-through; color: grey; }
    ul {
  list-style-type: none; /* removes bullets */
  padding: 0;
}

li {
  margin: 10px 0;
}

  </style>
</head>
<body>
  <h1>üìù My To-Do List</h1>
  <input type="text" id="taskInput" placeholder="New task">
  <button onclick="addTask()">Add</button>

  <ul id="taskList"></ul>

  <script>
    function fetchTasks() {
      fetch('/api/get/')
        .then(response => response.json())
        .then(data => {
          const list = document.getElementById('taskList');
          list.innerHTML = '';
          data.tasks.forEach(task => {
            const li = document.createElement('li');
            const checkbox = document.createElement('input');
            checkbox.type = 'checkbox';
            checkbox.checked = task.completed;
            checkbox.onchange = () => toggleComplete(task.id, checkbox.checked);

            const span = document.createElement('span');
            span.textContent = task.title;
            if (task.completed) span.classList.add('done');

            li.appendChild(checkbox);
            li.appendChild(span);
            list.appendChild(li);
          });
        });
    }

    function addTask() {
      const title = document.getElementById('taskInput').value;
      fetch('/api/add/', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ title })
      }).then(() => {
        document.getElementById('taskInput').value = '';
        fetchTasks();
      });
    }

    function toggleComplete(id, completed) {
      fetch(`/api/update/${id}/`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ completed })
      }).then(fetchTasks);
    }

    fetchTasks();
  </script>
</body>
</html>
